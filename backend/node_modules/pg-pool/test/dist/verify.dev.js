'use strict';

var expect = require('expect.js');

var describe = require('mocha').describe;

var it = require('mocha').it;

var Pool = require('../');

describe('verify', function () {
  it('verifies a client with a callback', false, function (done) {
    var pool = new Pool({
      verify: function verify(client, cb) {
        client.release();
        cb(new Error('nope'));
      }
    });
    pool.connect(function (err, client) {
      expect(err).to.be.an(Error);
      expect(err.message).to.be('nope');
      pool.end();
      done();
    });
  });
});